<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./styles/reset.css">
    <link rel="stylesheet" href="./styles/iii.css">
    <link rel="stylesheet" href="./styles/card_flip.css">
    <script src="./javascripts/animejs.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RS712JHMXF"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            window.dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'G-RS712JHMXF');
    </script>
</head>

<body>

    <div class="container">
        <div class="card-container">
            <div class="card">
                <div class="front">
                    <h1>Is It Isekai?</h1>&nbsp;&nbsp;&nbsp;
                    <input type="text" id="searchbox" placeholder="Search anime title"></input>&nbsp;&nbsp;&nbsp;
                    <button id="check">Find out!</button>
                </div>
                <div class="back">
                    <h1>Of course it is, weeb!</h1>&nbsp;&nbsp;&nbsp;
                    <button id="reset">Try again</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function background() {
            console.log('background() called');
            var number = Math.floor(Math.random() * 10);
            console.log('number', number);

            document.body.style.backgroundImage = "url('./images/" + number + ".jpg')";
            document.body.style.backgroundSize = "cover";
            document.body.style.backgroundPosition = "center";
            document.body.style.margin = "0";
        }

        function preload() {
            var images = [];

            for (var i = 0; i < arguments.length; i++) {
                console.log('preloading background image', i);
                images[i] = new Image();
                images[i].src = preload.arguments[i];
            }
        }

        preload(
            "./images/0.jpg",
            "./images/1.jpg",
            "./images/2.jpg",
            "./images/3.jpg",
            "./images/4.jpg",
            "./images/5.jpg",
            "./images/6.jpg",
            "./images/7.jpg",
            "./images/8.jpg",
            "./images/9.jpg"
        )

        window.addEventListener('DOMContentLoaded', (event) => {
            console.log('DOM fully loaded and parsed');
            background();

            var check = document.querySelector("#check");
            var reset = document.querySelector("#reset");

            var playing = false;

            check.addEventListener('click', function() {
                if (playing)
                    return;

                playing = true;
                anime({
                    targets: document.querySelector(".card"),
                    scale: [{
                        value: 1
                    }, {
                        value: 1.4
                    }, {
                        value: 1,
                        delay: 250
                    }],
                    rotateY: {
                        value: '+=180',
                        delay: 200
                    },
                    easing: 'easeInOutSine',
                    duration: 400,
                    complete: function(anim) {
                        playing = false;
                        background();
                    }
                });
            });

            reset.addEventListener('click', function() {
                if (playing)
                    return;

                playing = true;
                anime({
                    targets: document.querySelector(".card"),
                    scale: [{
                        value: 1
                    }, {
                        value: 1.4
                    }, {
                        value: 1,
                        delay: 250
                    }],
                    rotateY: {
                        value: '+=180',
                        delay: 200
                    },
                    easing: 'easeInOutSine',
                    duration: 400,
                    complete: function(anim) {
                        playing = false;
                        background();
                    }
                });

                document.getElementById("searchbox").value = ''
            });
        });
    </script>
</body>

</html>